---
import CallToAction from "@/components/cta/CallToAction.astro";
import ContactCTA from "@/components/cta/ContactCTA.astro";
import Hero from "@/components/hero/Hero.astro";

import Icon from "@/components/icons/Icon.astro";
import { PictureCarousel } from "@/components/react/PictureCarousel";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection, render } from "astro:content";

export const prerender = true;
export async function getStaticPaths() {
  const testimonials = await getCollection("testimonials");
  return testimonials.map((atleta) => ({
    params: { id: atleta.id },
    props: { atleta },
  }));
}

const { atleta } = Astro.props;
const { data } = atleta;
const { name, img, img2, img3, img4, img5 } = data;
const images = [img, img2, img3, img4, img5].filter((img): img is string =>
  Boolean(img)
);
const { Content } = await render(atleta);
---

<BaseLayout title=`Atletas | ${name}`>
  <main class="grid grid-rows-[250px_1fr]gap-20 mt-20">
    <header class="flex flex-col lg:grid lg:grid-cols-[250px_1fr]">
      <div class="flex self-start mb-14 ml-6">
        <CallToAction href="/atletas/">
          <span class="flex flex-row gap-3 text-base text-center">
            <Icon icon="arrow-left" size="1em" />
            Volver a seccion atletas</span
          >
        </CallToAction>
      </div>
    </header>
    <section class="flex flex-col items-center justify-center">
      <Hero align="center" title=`${name}` />
    </section>
    <section
      class="flex flex-col-reverse lg:grid lg:grid-cols-2 lg:mb-12 lg:ml-48 justify-center items-center"
    >
      <div class="content wrapper prose-slate prose-lg mx-auto p-3">
        <Content />
      </div>
      <div class="md:w-4/6 w-full h-auto">
        <PictureCarousel images={images} client:only />
      </div>
    </section>
    <section class="mt-12">
      <ContactCTA />
    </section>
  </main>
</BaseLayout>

<style>
  .content {
    max-width: 55ch;
    margin-inline: auto;
  }
</style>
